kt

hdfs dfs -put /opt/appl/bdai/tmp/TIERS.txt LCO

beeline -u $HIVE_URL

DROP TABLE TB_TIERS;
CREATE TABLE TB_TIERS (CD_PA string, SYS_APL_TIERS string, DT_JR date,
ID_GEST_TRS string, ID_EXT_TRS string, CD_TY_TRS string, CD_STA_CPTA_CLI string, CD_TY_CLI_RESO string, CD_CAT_JUR string )
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\;' 
TBLPROPERTIES("skip.header.line.count"="1");


LOAD DATA INPATH '/user/bdai/LCO/TIERS.txt' INTO TABLE TB_TIERS;



DROP TABLE TB_IMPAYES;
CREATE TABLE TB_IMPAYES (CD_PA string, SYS_APL string, DT_JR date,
ID_GEST_TRS string, ID_GEST_FIN string, DT_EXBL_ECH_IMP date, REF_ECH_IMP string, 
MT_INI_ECH_IMP int, MT_RCV_ECH_IMP int, DT_REGU_TOT_IMP date, SYS_APL_TIERS string )
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\;' 
TBLPROPERTIES("skip.header.line.count"="1");


LOAD DATA INPATH '/user/bdai/LCO/IMPAYES.txt' INTO TABLE TB_IMPAYES;


DROP TABLE TB_DONNEES_FINANCIERES;
CREATE TABLE TB_DONNEES_FINANCIERES (CD_PA string, SYS_APL string, DT_JR date,
ID_EXT_TRS string, DT_BIL date, MT_CA_TOT_HT_AN_0 bigint, MT_CAP_SOC bigint )
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\;' 
TBLPROPERTIES("skip.header.line.count"="1");


LOAD DATA INPATH '/user/bdai/LCO/DONNEES_FINANCIERES.txt' INTO TABLE TB_DONNEES_FINANCIERES;


DROP TABLE TB_EXPOSITIONS;
CREATE TABLE TB_EXPOSITIONS (CD_PA string, SYS_APL string, DT_JR date,
ID_GEST_EXPO string, ID_GEST_TRS string, CD_CAT_EXPO string, CD_QUAL_VEH string, CD_USG_VEH string, 
MT_INI_FIN int, SYS_APL_TIERS string )
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\;' 
TBLPROPERTIES("skip.header.line.count"="1");


LOAD DATA INPATH '/user/bdai/LCO/EXPOSITIONS.txt' INTO TABLE TB_EXPOSITIONS;


DROP TABLE TB_DEMANDES;
CREATE TABLE TB_DEMANDES (CD_PA string, SYS_APL string, DT_JR date,
NO_DMD string, ID_GEST_TRS string, DT_DMD date, CD_TY_CLI_RCI string, SYS_APL_TIERS string )
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\;' 
TBLPROPERTIES("skip.header.line.count"="1");


LOAD DATA INPATH '/user/bdai/LCO/DEMANDES.txt' INTO TABLE TB_DEMANDES;


DROP TABLE TB_VARIATION_DE_CREANCES;
CREATE TABLE TB_VARIATION_DE_CREANCES (CD_PA string, SYS_APL string, DT_JR date,
ID_GEST_EXPO string, MT_ABD_PERT int, MT_PAI int )
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\;' 
TBLPROPERTIES("skip.header.line.count"="1");


LOAD DATA INPATH '/user/bdai/LCO/VARIATION_DE_CREANCES.txt' INTO TABLE TB_VARIATION_DE_CREANCES;


DROP TABLE TW_ENCOURS;
CREATE TABLE TW_ENCOURS (CD_PA string, SYS_APL string, DT_JR date,
ID_GEST_EXPO string, MT_EXPO int )
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\;' 
TBLPROPERTIES("skip.header.line.count"="1");

LOAD DATA INPATH '/user/bdai/LCO/ENCOURS.txt' INTO TABLE TW_ENCOURS;



DROP TABLE TB_TIERS_CLASSE_RISQUE;
CREATE TABLE TB_TIERS_CLASSE_RISQUE (CD_PA string, SYS_APL_TIERS string, DT_JR date,
ID_GEST_TRS string, CLAS_RISQ_CLI string )
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\;' 
TBLPROPERTIES("skip.header.line.count"="1");

LOAD DATA INPATH '/user/bdai/LCO/CLRISQUE.txt' INTO TABLE TB_TIERS_CLASSE_RISQUE;














